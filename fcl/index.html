<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://songlll.pages.dev/web.css">
    <title>Fold Craft Launcher</title>
    <style>
        .version-card .desc {
            white-space: pre-line;
            margin: 0;
        }
    </style>
</head>

<body>
    <header>下载fold craft launcher</header>
    <main>
        <div class="bg" id="version_list"></div>

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/highlight.min.js"></script>

        <script>
            async function init() {
                try {
                    const res = await fetch(
                        "https://hk.gh-proxy.com/github.com/FCL-Team/FoldCraftLauncher/raw/refs/heads/main/version_map.json"
                    );
                    const jsonObj = await res.json();

                    const html_text = jsonObj.map(obj => {
                        // 安全获取描述
                        let mdText = "暂无描述";
                        if (Array.isArray(obj.description)) {
                            const descItem = obj.description.find(d => d.lang === "zh_CN")
                                || obj.description.find(d => d.lang === "en");
                            if (descItem && descItem.text) mdText = descItem.text;
                        }

                        const descHtml = marked.parse(mdText.replace(/\n/g, "\n\n"));


                        return `
                <div class="version-card">
                    <h1><a href="${obj.url.replace("https://", "https://gh-proxy.com/")}">版本：${obj.versionName}</a></h1>
                    <h1>描述：</h1><div>${descHtml}</div>
                    <h1>更新时间：${obj.date}</h1>
                </div>
            `;
                    }).join("");

                    document.getElementById("version_list").innerHTML = html_text;
                } catch (e) {
                    console.error("加载版本列表失败：", e);
                }
            }

            window.addEventListener("DOMContentLoaded", init);
        </script>
        <script>hljs.highlightAll();</script>
    </main>

</body>

</html>